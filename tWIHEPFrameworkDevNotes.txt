Reminder to call 

'source /cvmfs/sft.cern.ch/lcg/views/LCG_93/x86_64-slc6-gcc62-opt/setup.sh'
before compilation.

Utilities to make generic:

createPlots
useFileListsForCondor


TODOs:

Histograms as a config file?
JES and JER uncertainties are not treated the same
Electron ID currently uses cut-based. Implement MVA ID
Also other selection requirements can be changed.
Unisolated leptons have been cut.
Remove MET_xy variables
Lepton reweighting. In fact the weight class needs to be basically re-done based on nano information?

I could do with finding a more topical nanoAOD file to work with, and would like to check xroot performance.


contents of nanoAOD found here:  https://cms-nanoaod-integration.web.cern.ch/integration/cms-swCMSSW_10_6_19/mc102X_doc.html


Doing:

Make the example executable much more basic.

-Make sure grid certificate can work on hep_sub?

Done:

-Jet ID cut value has added to the configuration
-It *IS* possible to run the code on remote files using xrootd.
   - Using the proper prefix 'root://cmsxrootd.fnal.gov///store/<whateverPath' in the file list allows access to these files
   - Not recommended for local running as the reading from the tree can take a long time.
   - Can be considered for condor submission, although it asks for your PEM password for the grid certificate so I don't know if it will work?
      - Possibly there are some environment things that can be done here. 

-Utilities now available:
   - utils/makeFileListsFromLocalDirectories.py
      - If you have a bunch of files locally this will make the necessary file lists for them
-Added trigger informaton to the event container
   - As something of a corrolary to this, it strips the HLT information from the nanoAODTree object, because I am re-casting the BranchAddress of the original TTree directly into the trigger object, so all work with the trigger information must necessarily then be done from the EventContainer. Which is probably fine?
   - CutTriggerSelection class now takes in two comma separated lists of triggers for OR and NOT comparison from the configuration file
-Pileup reweighting is re-implemented
   - analysers are encouraged to calculate their own PV distributions for data, MC and syst variations.
-Change 'AddCuts' to 'AddAction'
   - Added in AddAction for generic actions (think EventWeight)
   - Added in AddHists which are not allowed to reject events
-All objects are now read directly from input tree and labelled as tight, veto, etc if they pass each separate set of requirements.
   - Do jets need a similar thing to electrons and muons where they have different classes? Like Tight or Veto or whatever? 
   - Change the way leptons are selected so thta we don't have to read from the tree four times every event
-Simplifying example exectuable by trimming the fat
   - Removed MCatNLO option
   - Removed whichtrig (which was meaningless at this time)
-Jet cleaning leptons are now set to tight leptons by default. Might be useful to be able to switch them to veto, or unisolated or whatever, so the functionality remains.

Nominally working nanoTest.sh cutflow (so I can check my changes aren't messing everything up...):

<CutFlowTable> GlobalCutFlow result:
-----------------------------------------------------------------------------------------------------------------------------
|    Cut Name                    |        exposed         |        pass            |      cut
|                                |  count  |     yield    |  count  |    yield     |
|           TightMuon.Number.Min |  398904 |      24687.7 |   98059 |      6068.77 | Tight Muon : N >= 1
|           TightMuon.Number.Max |  398904 |      24687.7 |  395218 |      24459.6 | Tight Muon : N <= 1
|           TightMuon.Number.All |  398904 |      24687.7 |   94373 |      5840.64 | Tight Muon : 1 <= N <= 1
|       TightElectron.Number.Min |   94373 |      5840.64 |   94373 |      5840.64 | Tight Electron : N >= 0
|       TightElectron.Number.Max |   94373 |      5840.64 |   88852 |      5498.95 | Tight Electron : N <= 0
|       TightElectron.Number.All |   94373 |      5840.64 |   88852 |      5498.95 | Tight Electron : 0 <= N <= 0
|                 Jet.Number.Min |   88852 |      5498.95 |   70265 |      4348.62 | Jet : N >=2
|                 Jet.Number.Max |   88852 |      5498.95 |   83029 |      5138.58 | Jet : N <= 4
|                 Jet.Number.All |   88852 |      5498.95 |   64442 |      3988.25 | Jet : 2 <= N <= 4
-----------------------------------------------------------------------------------------------------------------------------
